!function(d){d.su.moduleManager.define("wakeLan",{models:["wakeLanModel","wolDeviceModel"],stores:["wolWakeListStore","wolOfflineDevicesStore","wolConnectedDevicesStore"],services:["ajax"],views:["wakeLanAdvView"],listeners:{ev_on_launch:function(e,t,a,n,i,o,c){i.wolWakeListStore.load()}},init:function(a,n,c,s,e,t){this.configViews({id:"wakeLanAdvView",items:[{id:"grid-wakeup-device-list",configs:{tbar:{add:{text:d.su.CHAR.WOL.ADD_DEVICE,index:0}},popEditor:{addTitle:d.su.CHAR.WOL.ADD_DEVICE,content:"#grid-device-editor",fields:[{name:"name"},{name:"mac"},{name:"autoWake"}]},paging:{},columns:[{text:d.su.CHAR.WOL.DEVICE_NAME,dataIndex:"name"},{text:d.su.CHAR.WOL.AUTO_WAKE,dataIndex:"enable",xtype:"customWidget",widgetName:"switch",cls:"status l-hide xl-hide",settings:{trueValue:"on",falseValue:"off"}},{text:d.su.CHAR.WOL.MAC_ADDRESS,dataIndex:"mac"},{text:d.su.CHAR.WOL.AUTO_WAKE,dataIndex:"enable",xtype:"customWidget",widgetName:"switch",cls:"status s-hide m-hide",settings:{trueValue:"on",falseValue:"off"}},{xtype:"actioncolumn",text:d.su.CHAR.WOL.OPERATION,renderer:function(e,t){var a='<a href="javascript:void(0)" class="grid-content-btn btn-power">';a+='<span class="icon"></span>';return'<a href="javascript:void(0)" class="grid-content-btn btn-power"><span class="icon"></span><span class="text"></span></a><a href="javascript:void(0)" class="grid-content-btn grid-content-btn-delete btn-delete"><span class="icon"></span><span class="text"></span></a>'}}]}},{id:"offline-device-list",configs:[{type:"logo",dataIndex:"deviceType"},{type:"deviceName",dataIndex:"name"},{type:"mac",dataIndex:"mac"}]},{id:"connected-device-list",configs:[{type:"logo",dataIndex:"deviceType"},{type:"deviceName",dataIndex:"name"},{type:"mac",dataIndex:"mac"}]}]}),this.control({"#offline-device-button":{ev_button_click:function(e){s.wolOfflineDevicesStore.load(),n.wakeLanAdvView.offlineDeviceMsg.show()}},"#offline-device-list":{ev_item_click:function(e,t){c.wakeLanModel.mac.setValue(t.mac),n.wakeLanAdvView.offlineDeviceMsg.hide()}},"#connected-device-button":{ev_button_click:function(e){s.wolConnectedDevicesStore.load(),n.wakeLanAdvView.connectedDeviceMsg.show()}},"#connected-device-list":{ev_item_click:function(e,t){c.wolDeviceModel.name.setValue(t.name),c.wolDeviceModel.mac.setValue(t.mac),n.wakeLanAdvView.connectedDeviceMsg.hide()}},"#wake-up-button":{ev_button_click:function(e){var t=c.wakeLanModel.mac.getValue();s.wolWakeListStore.getData();c.wakeLanModel.getProxy().doWake({data:{mac:t},success:function(){s.wolWakeListStore.load()}})}},"#grid-wakeup-device-list":{ev_grid_before_save:function(e,t){for(var a=c.wolDeviceModel.mac.getValue(),n=s.wolWakeListStore.getData(),i=0,o=n.length;i<o;i++)if(n[i].mac===a)return c.wolDeviceModel.mac.setError(d.su.CHAR.ERROR["00000051"]),t.preventDefault(),!1}},"#grid-wakeup-device-list => .btn-power":{ev_grid_action_click:function(e,t){t=s.wolWakeListStore.getModelByKey(t).mac.getValue();a.wakeUpDevice(t)}}}),this.listen({"stores.wolWakeListStore":{ev_data_change:function(e,t,a){t.value!==t.oldValue&&"enable"===a.getName()&&s.wolWakeListStore.sync()}}})}},function(e,t,a,n,i,o){return{wakeUpDevice:function(e){o.ajax.request({proxy:"wakeUpProxy",data:{mac:e},success:function(e){n.wolWakeListStore.load()}})},checkConflict:function(e,t){for(var a=t.getData(),n=0;n<a.length;n++)if(a[n].mac===e)return!0;return!1}}})}(jQuery);